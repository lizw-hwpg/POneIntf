<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- jquery -->
<script type="text/javascript" s src="vendor/jquery-1.12.4.js"></script>    
<!-- bootstrap-->
<link rel="Stylesheet" href="vendor/bootstrap-4.3.1/css/bootstrap.min.css" />
<script type="text/javascript" src="vendor/bootstrap-4.3.1/js/bootstrap.min.js"></script>
<!-- vue.js-->    
<script type="text/javascript" src="vendor/vue/vue.min.js"></script>
<title>Demo</title>
</head>
<body>

    <div class="d-flex">        
        <ul class="nav nav-tabs flex-column" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="basic-tab" data-toggle="tab" href="#logincheck" role="tab" aria-controls="home" aria-selected="true">logincheck</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="advanced-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="advanced" aria-selected="false">Advanced</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="other-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="other" aria-selected="false">Others</a>
            </li>
        </ul>
        <div class="tab-content p-2" id="myTabContent">
            <div class="tab-pane fade show active" id="logincheck" role="tabpanel" aria-labelledby="logincheck-tab">
                <div class="form-group">
                    <label for="username">UserId</label>
                    <input type="text" class="form-control param" id="username" placeholder="User Id">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" class="form-control param" id="password" placeholder="Password">
                </div>
                <button type="button" class="btn btn-primary">3.1_LoginCheck</button>  
            </div>
            <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="advanced-tab">...</div>
            <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="other-tab">...</div>
        </div>
        <div id="result">result</div>
    </div>

    <script type="text/javascript">

        $(".btn").on("click", function () {
            $("#result").html(""); //清空结果区域
            var btnObj = this;
            btnObj.setAttribute("disabled", ""); //禁用按钮            

            var req = {};
            req["from"] = "sender";
            req["timestamp"] = (new Date()).toLocaleString();
            req["nonce"] = Math.floor(Math.random() * Math.floor(99));
            req["sign"] = ""; //暂不实现
            var act = this.parentElement.id;
            var data = {};
            $("#" + act + " .param").each(function () { //取当前按钮业务下的所有参数
                data[this.getAttribute("id")] = this.value;
            });
            req["data"] = data;
            console.log(req);
            //发起ajax请求，完成业务提交
            $.ajax({
                url: "gear.ashx?act=" + act,
                method: "POST",
                contentType: "application/json; charset=UTF-8",
                data: JSON.stringify(req),
                dataType: "json",
                success: function (response) {
                    btnObj.removeAttribute("disabled");
                    if (act == "logincheck") {
                        
                    }
                    $("#result").html(response.code + ":" + response.msg);
                },
                error: function (xhr, status, error) {
                    btnObj.removeAttribute("disabled");
                    $("#result").html("ajax failure" + status);
                }
            });
        });

       
    </script>
</body>
</html>
